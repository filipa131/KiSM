S2box = [
    [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],
    [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],
    [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],
    [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]
]

def XOR(first, second):
    result = ""
    for i in range(len(first)):
        if first[i] == second[i]:
            result += '0'
        else:
            result += '1'
    return result

def S2(input):
    r = input[0] + input[5]
    s = input[1:5]

    row = int(r, 2)
    column = int(s, 2)

    resbits = format(S2box[row][column], '04b')
    return resbits

def main():
    # Enter your values here:
    E2 = "000100"
    E2star = "110000"
    C2 = "1011"

    IN2 = [None] * 4
    test2 = [None] * 4

    B2 = [
        "000000", "000010", "000100", "001000", "010000", "000110", "001010", "010010",
        "010100", "011000", "001100", "011100", "011010", "010110", "001110", "011110",
        "000001", "000011", "000101", "001001", "010001", "000111", "001011", "010011",
        "010101", "011001", "001101", "011101", "011011", "010111", "001111", "011111",
        "100000", "100010", "100100", "101000", "110000", "100110", "101010", "110010",
        "110100", "111000", "101100", "111100", "111010", "110110", "101110", "111110",
        "100001", "100011", "100101", "101001", "110001", "100111", "101011", "110011",
        "110101", "111001", "101101", "111101", "111011", "110111", "101111", "111111"
    ]

    j = 0
    for i in range(64):
        tmp = XOR(S2(B2[i]), S2(XOR(B2[i], "110100")))
        if tmp == C2:
            if j < 4:
                IN2[j] = B2[i]
                j += 1

    print("\nIN2 = ", end="")
    for i in range(len(IN2)):
        if (i < len(IN2) - 1): print(IN2[i], end=", ")
        else: print(IN2[i])


    print("\ntest2 = ", end="")
    for i in range(len(IN2)):
        test2[i] = XOR(IN2[i], E2)
        if (i < len(IN2) - 1): print(test2[i], end=", ")
        else: print(test2[i])
    print()

if __name__ == "__main__":
    main()